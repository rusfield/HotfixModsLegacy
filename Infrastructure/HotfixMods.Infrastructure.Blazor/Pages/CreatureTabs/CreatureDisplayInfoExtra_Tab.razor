@using HotfixMods.Core.Enums.TrinityCore;
@using HotfixMods.Infrastructure.Blazor.Components.DtoContent
@using HotfixMods.Core.Enums.Db2

@inherits DtoContentBase<CreatureDto, CreatureDisplayInfoExtra>

<StandardDtoContent T="CreatureDisplayInfoExtra">
    <MudItem xs="3">
        <Input_Element T="sbyte" Value="Value.DisplayRaceID" ValueChanged="DisplayRaceIdChanged" ValueCompare="ValueCompare?.DisplayRaceID" Label="@nameof(Value.DisplayRaceID).ToDisplayName()" GetOptionsAsync_Func="GetRaces" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.DisplayRaceID)))" />
        <Input_Element T="sbyte" @bind-Value="Value.DisplayClassID" ValueCompare="ValueCompare?.DisplayClassID" Label="@nameof(Value.DisplayClassID).ToDisplayName()" GetOptionsAsync_Func="GetClasses" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.DisplayClassID)))" />
        <Input_Element T="sbyte" Value="Value.DisplaySexID" ValueChanged="DisplaySexIdChanged" ValueCompare="ValueCompare?.DisplaySexID" Label="@nameof(Value.DisplaySexID).ToDisplayName()" GetOptionsAsync_Func="GetGenders" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.DisplaySexID)))" />
    </MudItem>
    <MudItem xs="6">
        <Placeholder_Element Amount="4" />
    </MudItem>
    <MudItem xs="3">
        <Input_Element T="sbyte" @bind-Value="Value.Flags" ValueCompare="ValueCompare?.Flags" Label="@nameof(Value.Flags).ToDisplayName()" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.Flags)))" />
        <Input_Element T="int" @bind-Value="Value.HDBakeMaterialResourcesID" ValueCompare="ValueCompare?.HDBakeMaterialResourcesID" Label="HD Bake Material Resources ID" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.HDBakeMaterialResourcesID)))" />
        <Input_Element T="int" @bind-Value="Value.BakeMaterialResourcesID" ValueCompare="ValueCompare?.BakeMaterialResourcesID" Label="@nameof(Value.BakeMaterialResourcesID).ToDisplayName()" OnInfoAdornmentClick="@(OpenInfoDialog(nameof(CreatureDisplayInfoExtra.BakeMaterialResourcesID)))" />
    </MudItem>
</StandardDtoContent>

@code {
    // Used to refresh Display Info Options
    [CascadingParameter(Name = "RefreshIndex")]
    public Action RefreshIndex { get; set; }

    void DisplayRaceIdChanged(sbyte id)
    {
        Value.DisplayRaceID = id;
        RefreshIndex();
    }

    void DisplaySexIdChanged(sbyte id)
    {
        Value.DisplaySexID = id;
        RefreshIndex();
    }

    async Task<Dictionary<sbyte, string>> GetGenders()
    {
        return Enum.GetValues<Gender>().ToDictionary(key => (sbyte)key, value => value.ToDisplayString());
    }

    async Task<Dictionary<sbyte, string>> GetClasses()
    {
        return Enum.GetValues<ChrClassId>().ToDictionary(key => (sbyte)key, value => value.ToDisplayString());
    }

    async Task<Dictionary<sbyte, string>> GetRaces()
    {
        return Enum.GetValues<ChrRaceId>().ToDictionary(key => (sbyte)key, value => value.ToDisplayString());
    }

}